<html>
<head>
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.8/jquery.min.js"></script>
<style type="text/css">
body {
	font-family: monospace;
	counter-reset: test;
}
.box {
	margin: 0.5em;
	padding: 0.5em 0.8em;
	border: 1px solid #ddd;
	clear: both;
	float: left;
	position: relative;
}
.box div {
	padding: 0.5em;
	white-space: nowrap;
}
.box div span {
	color: #ccc;
	margin-left: 1.2em;
}
.box div span:nth-child(1) {
	margin-left: 0;
	color: #000;
}
.box div.victory span {
	color: #2c2;
}
.test::before {
	counter-increment: test;
	content: counter(test);
	position: absolute;
	right: 2px;
	bottom: 1px;
	display: block;
	font-size: 1em;
	line-height: 1;
	color: rgba(0,0,0,0.1);
}
.winner {
	clear: none;
}
</style>
<script>

util = {
	rand: function(min,max){
		return min+Math.round(Math.random()*(max-min));
	}
}

/*function prog1() {
	var a = Math.random(),
		b = 'brfoerf';
	var c = a+0,
		d = b+0;
}

function prog2() {
	var a = Math.random(),
		b = 'brfoerf';
	var c = a*1,
		d = b*1;
}

function prog3() {
	var a = Math.random(),
		b = 'brfoerf';
	var c = +a,
		d = +b;
}*/

/*
function prog1(){
	var a = eval(Array(100).join('3*')+'3')
}
function prog2(){
	var a = 3*3*3*3*3*3*3*3*3*3*3*3*3*3*3*3*3*3*3*3*3*3*3*3*3*3*3*3*3*3*3*3*3*3*3*3*3*3*3*3*3*3*3*3*3*3*3*3*3*3*3*3*3*3*3*3*3*3*3*3*3*3*3*3*3*3*3*3*3*3*3*3*3*3*3*3*3*3*3*3*3*3*3*3*3*3*3*3*3*3*3*3*3*3*3*3*3*3*3*3
}
function prog3(){
	var a = Math.pow(3,100)
}
*/

/*function prog1(){
	var test = [
		{1:1, 2:2, 3:'wefwef'}
		,[1,2,'wefwef']
	];
	for (var i=0;i<test.length;++i) {
		var res = test[i] instanceof Array;
	}
}
function prog2(){
	var test = [
		{1:1, 2:2, 3:'wefwef'}
		,[1,2,'wefwef']
	];
	for (var i=0;i<test.length;++i) {
		var res = Array.isArray(test[i]);
	}
}
function prog3(){
	var test = [
		{1:1, 2:2, 3:'wefwef'}
		,[1,2,'wefwef']
	];
	for (var i=0;i<test.length;++i) {
		var res = test[i].constructor === Array;
	}
}*/

/*
function prog1(){
	var test = [
		{1:1, 2:2, 3:'wefwef'}
		,[1,2,'wefwef']
	];
	for (var i=0;i<test.length;++i) {
		var res = test[i] instanceof Object;
	}
}
function prog2(){
	var test = [
		{1:1, 2:2, 3:'wefwef'}
		,[1,2,'wefwef']
	];
	for (var i=0;i<test.length;++i) {
		var res = typeof test[i] == 'object' && test[i] !== null;
	}
}
function prog3(){
	var test = [
		{1:1, 2:2, 3:'wefwef'}
		,[1,2,'wefwef']
	];
	for (var i=0;i<test.length;++i) {
		var res = typeof test[i] === 'object' && test[i] !== null;
	}
}
function prog4(){
	var test = [
		{1:1, 2:2, 3:'wefwef'}
		,[1,2,'wefwef']
	];
	for (var i=0;i<test.length;++i) {
		toString.call(test[i]) != '[object Object]';
	}
}
function prog5(){
	var test = [
		{1:1, 2:2, 3:'wefwef'}
		,[1,2,'wefwef']
	];
	for (var i=0;i<test.length;++i) {
		toString.call(test[i]) !== '[object Object]';
	}
}
*/


function hasSuffiecentCharacters1(newspaperClipping, ransomLetter) {
	var i, k, char, ransomChars = {}
		,clipping = newspaperClipping.toLowerCase().replace(/\s/g,'').split('')
		,letter = ransomLetter.toLowerCase().replace(/\s/g,'').split('')
	if (!ransomLetter.length)
		return true
	for (i=0;i<letter.length;++i)
		ransomChars[char = letter[i]] = ransomChars[char] ? ransomChars[char]+1 : 1
	for (i=0;i<clipping.length;++i) {
		if (ransomChars[char = clipping[i]] && --ransomChars[char] == 0) {
			delete ransomChars[char], k = null
			for (k in ransomChars) break
			if (!k) return true
		}
	}
	//if (Math.random()<0.1) return true;
	return false
}
function hasSuffiecentCharacters2(newspaperClipping, ransomLetter) {
	var i, k, char, ransomChars = {}
		,clipping = newspaperClipping.toLowerCase().split('')
		,letter = ransomLetter.toLowerCase().split('')
	if (!ransomLetter.length)
		return true
	for (i=0;i<letter.length;++i)
		if (letter[i] != ' ')
			ransomChars[char = letter[i]] = ransomChars[char] ? ransomChars[char]+1 : 1
	for (i=0;i<clipping.length;++i) {
		if (ransomChars[char = clipping[i]] && --ransomChars[char] == 0) {
			delete ransomChars[char], k = null
			for (k in ransomChars) break
			if (!k) return true
		}
	}
	//if (Math.random()<0.1) return true;
	return false
}
function hasSuffiecentCharacters3(newspaperClipping, ransomLetter) {
	var index,i;
	newspaperClipping = newspaperClipping.toLowerCase();
	ransomLetter = ransomLetter.toLowerCase();
	for (var i=0;i<ransomLetter.length;++i) {
		if (ransomLetter[i] == ' ') continue;
		if ((index = newspaperClipping.indexOf(ransomLetter[i])) == -1)
			return false
		newspaperClipping = newspaperClipping.substr(0,index)+newspaperClipping.substr(index+1);
	}
	return true
}
function hasSuffiecentCharacters4(newspaperClipping, ransomLetter) {
	var next,i;
	newspaperClipping = newspaperClipping.toLowerCase();
	ransomLetter = ransomLetter.toLowerCase();
	for (var i=0;i<ransomLetter.length;++i)
		if (ransomLetter[i] != ' ' && newspaperClipping.length == (newspaperClipping = newspaperClipping.replace(ransomLetter[i],'')).length)
			return false
	return true
}
function preProg(){
	var abc = 'abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ-', i;
	window.str0 = window.str1 = '';
	for (i=0;i<util.rand(200,2000);++i)
		window.str0 += Math.random()<0.15 ? ' ' : abc[util.rand(0,abc.length-1)];
	for (i=0;i<util.rand(50,500);++i)
		window.str1 += Math.random()<0.15 ? ' ' : abc[util.rand(0,abc.length-1)];
	console.log(window.str0);
	console.log(window.str1);
}
function prog1(i){
	//return hasSuffiecentCharacters('Churchill had a very distant relationship with this father. Often people with depression don’t have a close relationship with their father, predisposing them to anger or anger turned inward – depression. His first major episode with depression was in 1910, aged 35. Some days he described himself as almost unable to get out of bed, a sign of deep clinical depression. He would also fantasize about jumping in front of an oncoming train when on a  platform. “I don’t like standing near the edge of a platform when an express train is passing through,” he told his doctor. “I like to stand right back and if possible get a pillar between me and the train. I don’t like to stand by the side of a ship and look down into the water. A second’s action would end everything. A few drops of desperation.”', 'I have your code, please give me github access to get it back');
	return hasSuffiecentCharacters1(window.str0, window.str1);
}
function prog2(i){
	//return hasSuffiecentCharacters2('Churchill had a very distant relationship with this father. Often people with depression don’t have a close relationship with their father, predisposing them to anger or anger turned inward – depression. His first major episode with depression was in 1910, aged 35. Some days he described himself as almost unable to get out of bed, a sign of deep clinical depression. He would also fantasize about jumping in front of an oncoming train when on a  platform. “I don’t like standing near the edge of a platform when an express train is passing through,” he told his doctor. “I like to stand right back and if possible get a pillar between me and the train. I don’t like to stand by the side of a ship and look down into the water. A second’s action would end everything. A few drops of desperation.”', 'I have your code, please give me github access to get it back');
	return hasSuffiecentCharacters2(window.str0, window.str1);
}
function prog3(i){
	//return hasSuffiecentCharacters3('Churchill had a very distant relationship with this father. Often people with depression don’t have a close relationship with their father, predisposing them to anger or anger turned inward – depression. His first major episode with depression was in 1910, aged 35. Some days he described himself as almost unable to get out of bed, a sign of deep clinical depression. He would also fantasize about jumping in front of an oncoming train when on a  platform. “I don’t like standing near the edge of a platform when an express train is passing through,” he told his doctor. “I like to stand right back and if possible get a pillar between me and the train. I don’t like to stand by the side of a ship and look down into the water. A second’s action would end everything. A few drops of desperation.”', 'I have your code, please give me github access to get it back');
	return hasSuffiecentCharacters3(window.str0, window.str1);
}
function prog4(i){
	//return hasSuffiecentCharacters4('Churchill had a very distant relationship with this father. Often people with depression don’t have a close relationship with their father, predisposing them to anger or anger turned inward – depression. His first major episode with depression was in 1910, aged 35. Some days he described himself as almost unable to get out of bed, a sign of deep clinical depression. He would also fantasize about jumping in front of an oncoming train when on a  platform. “I don’t like standing near the edge of a platform when an express train is passing through,” he told his doctor. “I like to stand right back and if possible get a pillar between me and the train. I don’t like to stand by the side of a ship and look down into the water. A second’s action would end everything. A few drops of desperation.”', 'I have your code, please give me github access to get it back');
	return hasSuffiecentCharacters4(window.str0, window.str1);
}




function arrange($test) {
	$test.children().sort(function(a,b){
		return a.getElementsByTagName('span')[1].innerHTML > b.getElementsByTagName('span')[1].innerHTML ? 1 : -1;
	}).appendTo($test);
}

$(function(){
	var $b = $('body')
		,runNum = 10000
		,wait = 1000
		,run = []
		,runTestNTimes = 5
		,stats = {}
	;

	function runTest(cb){
		Object.keys(window).forEach(function(k){
			if (/^prog([0-9]+)$/.test(k) && window[k] instanceof Function)
				run.push(k);
		});
		run.sort(function(){return Math.random()-0.5;});
		console.log('run',run);

		var $test = $('<div class="test box"></div>').appendTo($b), best;
		function runNext(){
			var k
				,prog = window[k=run.shift()]
				,d0 = new Date
				,ms,i,$score
			;
			d1 = new Date();
			for (i=0;i<runNum;++i)
				prog(i);
			ms = +new Date - +d0;
			$test.append($score=$('<div><span>'+ms+'</span><span>('+k+')</span><span>'+prog()+'</span></div>'));
			if (!stats[k])
				stats[k] = {k:k, ms:[], wins:0};
			stats[k].ms.push(ms);
			if (!best || ms < best.ms)
				best = {k:k, ms:ms, $:$score};
			if (run[0])
				return setTimeout(runNext,wait);
			++stats[best.k].wins;
			best.$.addClass('victory');
			arrange($test);
			cb();
		}
		if (window.preProg)
			window.preProg();
		setTimeout(runNext,wait);
	}

	(function gamut(){
		runTest(function(){
			if (--runTestNTimes)
				return gamut();
			var best;
			Object.keys(stats).forEach(function(k){
				if (!best || stats[k].wins > best.wins)
					best = stats[k];
			});
			$b.prepend('<div class="winner box"><div><span>Winner:</span><span>'+best.k+'</span><span>Wins: '+best.wins+'/'+best.ms.length+'</span><span>Avg ms: '+(best.ms.reduce(function(a,b){return a+b})/best.ms.length).toFixed(2)+'</span></div></div>');
		});
	})();

});
</script>
</head>
<body>


</body>
</html>